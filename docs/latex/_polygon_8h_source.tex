\doxysection{Polygon.\+h}
\hypertarget{_polygon_8h_source}{}\label{_polygon_8h_source}\index{hittable/Polygon.h@{hittable/Polygon.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ \_POLYGON\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ \_POLYGON\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}HittableObject.h"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}Mesh.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}../Material.h"{}}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ "{}Triangle.h"{}}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00011\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_polygon}{Polygon}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_hittable_object}{HittableObject}}\ \{}
\DoxyCodeLine{00012\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_mesh}{Mesh}}\ *mesh;}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_material}{Material}}\ *material;}
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{keywordtype}{int}\ faceIndex;}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{class_polygon}{Polygon}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_mesh}{Mesh}}\ *mesh,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_material}{Material}}\ *material,\ \textcolor{keywordtype}{int}\ faceIndex)\ noexcept\ :}
\DoxyCodeLine{00018\ \ \ \ \ \ \ \ \ mesh(mesh),\ material(material),\ faceIndex(faceIndex)\ \{\}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{bool}\ Hit(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_ray}{Ray}}\ \&ray,\ \textcolor{keywordtype}{float}\ tMin,\ \textcolor{keywordtype}{float}\ tMax,\ \mbox{\hyperlink{struct_hit_payload}{HitPayload}}\ \&payload)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00021\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_hit_payload}{HitPayload}}\ hitPayload;}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ hitPayload.t\ =\ Math::Constants::Infinity<float>;}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ hitPayload.normal\ =\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}(0.f);}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ hitPayload.material\ =\ \textcolor{keyword}{nullptr};}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (MakeTriangle().Hit(ray,\ tMin,\ tMax,\ payload))\ \{}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ vertices\ =\ mesh-\/>GetVertices();}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ indices\ =\ mesh-\/>GetIndices();}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ v0\ =\ vertices[indices[3\ *\ faceIndex\ +\ 0]].position;}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ v1\ =\ vertices[indices[3\ *\ faceIndex\ +\ 1]].position;}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ v2\ =\ vertices[indices[3\ *\ faceIndex\ +\ 2]].position;}
\DoxyCodeLine{00033\ }
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n0\ =\ vertices[indices[3\ *\ faceIndex\ +\ 0]].normal;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n1\ =\ vertices[indices[3\ *\ faceIndex\ +\ 1]].normal;}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ n2\ =\ vertices[indices[3\ *\ faceIndex\ +\ 2]].normal;}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ \ \ \ n0\ =\ Math::Dot(ray.\mbox{\hyperlink{struct_ray_a32df584151ce19edb6cba1879bda747a}{direction}},\ n0)\ >\ Math::Constants::Epsilon<float>\ ?\ -\/n0\ :\ n0;}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ n1\ =\ Math::Dot(ray.\mbox{\hyperlink{struct_ray_a32df584151ce19edb6cba1879bda747a}{direction}},\ n1)\ >\ Math::Constants::Epsilon<float>\ ?\ -\/n1\ :\ n1;}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ n2\ =\ Math::Dot(ray.\mbox{\hyperlink{struct_ray_a32df584151ce19edb6cba1879bda747a}{direction}},\ n2)\ >\ Math::Constants::Epsilon<float>\ ?\ -\/n2\ :\ n2;}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ p\ =\ ray.origin\ +\ ray.\mbox{\hyperlink{struct_ray_a32df584151ce19edb6cba1879bda747a}{direction}}\ *\ payload.t;}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ u0\ =\ Math::Length(Math::Cross(v1\ -\/\ p,\ v2\ -\/\ p))\ /\ Math::Length(Math::Cross(v1\ -\/\ v0,\ v2\ -\/\ v0));}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ u1\ =\ Math::Length(Math::Cross(v0\ -\/\ p,\ v2\ -\/\ p))\ /\ Math::Length(Math::Cross(v1\ -\/\ v0,\ v2\ -\/\ v0));}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ u2\ =\ 1.f\ -\/\ u1\ -\/\ u0;}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ payload.normal\ =\ Math::Normalize(n0\ *\ u0\ +\ n1\ *\ u1\ +\ n2\ *\ u2);}
\DoxyCodeLine{00049\ }
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00054\ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ GetCentroid()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MakeTriangle().GetCentroid();}
\DoxyCodeLine{00058\ \ \ \ \ \}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_a_a_b_b}{AABB}}\ GetBoundingBox()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MakeTriangle().GetBoundingBox();}
\DoxyCodeLine{00062\ \ \ \ \ \}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ SampleUniform(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector2f}}\ \&sample)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MakeTriangle().SampleUniform(sample);}
\DoxyCodeLine{00066\ \ \ \ \ \}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{float}\ GetArea()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \textcolor{keyword}{override}\ \{}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ MakeTriangle().GetArea();}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00073\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{class_shapes_1_1_triangle}{Shapes::Triangle}}\ MakeTriangle()\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ vertices\ =\ mesh-\/>GetVertices();}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \textcolor{keyword}{auto}\ indices\ =\ mesh-\/>GetIndices();}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_shapes_1_1_triangle}{Shapes::Triangle}}(vertices[indices[3\ *\ faceIndex\ +\ 0]].position,\ vertices[indices[3\ *\ faceIndex\ +\ 1]].position,\ vertices[indices[3\ *\ faceIndex\ +\ 2]].position,\ material);}
\DoxyCodeLine{00077\ \ \ \ \ \}}
\DoxyCodeLine{00078\ \};}
\DoxyCodeLine{00079\ }
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
