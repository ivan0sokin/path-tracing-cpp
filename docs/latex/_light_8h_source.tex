\doxysection{Light.\+h}
\hypertarget{_light_8h_source}{}\label{_light_8h_source}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ \_LIGHT\_H}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ \_LIGHT\_H}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ "{}hittable/HittableObject.h"{}}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ "{}math/Math.h"{}}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ "{}Ray.h"{}}}
\DoxyCodeLine{00007\ \textcolor{preprocessor}{\#include\ "{}HitPayload.h"{}}}
\DoxyCodeLine{00008\ }
\DoxyCodeLine{00010\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_light}{Light}}\ \{}
\DoxyCodeLine{00011\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00012\ \ \ \ \ \textcolor{keyword}{constexpr}\ \mbox{\hyperlink{class_light}{Light}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_hittable_object}{HittableObjectPtr}}\ \textcolor{keywordtype}{object},\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ \&emission)\ noexcept\ :}
\DoxyCodeLine{00013\ \ \ \ \ \ \ \ \ m\_Object(\textcolor{keywordtype}{object}),\ m\_Emission(emission)\ \{\}}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_hittable_object}{HittableObject}}*\ \mbox{\hyperlink{class_light_abbd623085decc9b311b1dc881a44b585}{GetObject}}()\ const\ noexcept\ \{}
\DoxyCodeLine{00017\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_Object;}
\DoxyCodeLine{00018\ \ \ \ \ \}}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00021\ \ \ \ \ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ \mbox{\hyperlink{class_light_a825912082123457b823d2ac6c17778a6}{Sample}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{struct_ray}{Ray}}\ \&lightRay,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_hit_payload}{HitPayload}}\ \&objectHitPayload,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_hit_payload}{HitPayload}}\ \&lightHitPayload,\ \textcolor{keywordtype}{float}\ distance,\ \textcolor{keywordtype}{float}\ distanceSquared)\ \textcolor{keyword}{const}\ \textcolor{keyword}{noexcept}\ \{}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{float}\ distanceEpsilon\ =\ 0.01f;}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (Math::Abs(lightHitPayload.t\ -\/\ distance)\ >\ distanceEpsilon)\ \{}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}(0.f);}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ pdf\ =\ distanceSquared\ /\ (Math::Dot(lightHitPayload.normal,\ -\/lightRay.direction)\ *\ m\_Object-\/>GetArea());}
\DoxyCodeLine{00028\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{float}\ pdfEpsilon\ =\ 0.01f;}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (pdf\ <=\ pdfEpsilon)\ \{}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}(0.f);}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ brdf\ =\ objectHitPayload.material-\/>albedo\ *\ Math::Constants::InversePi<float>\ *\ Math::Dot(objectHitPayload.normal,\ lightRay.direction)\ *\ m\_Emission;}
\DoxyCodeLine{00035\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ brdf\ /\ pdf;}
\DoxyCodeLine{00037\ \ \ \ \ \}}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00040\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_hittable_object}{HittableObject}}*\ m\_Object;}
\DoxyCodeLine{00041\ \ \ \ \ \mbox{\hyperlink{struct_math_1_1_types_1_1_vector}{Math::Vector3f}}\ m\_Emission;}
\DoxyCodeLine{00042\ \};}
\DoxyCodeLine{00043\ }
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
